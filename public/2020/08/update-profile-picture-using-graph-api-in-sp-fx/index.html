<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Update Profile Picture Using Graph API In SPFx - Kunj Sangani</title><meta name="Description" content="Using Microsoft Graph API to update profile picture for all Microsoft 365 applications via SPFx webpart."><meta property="og:title" content="Update Profile Picture Using Graph API In SPFx" />
<meta property="og:description" content="Using Microsoft Graph API to update profile picture for all Microsoft 365 applications via SPFx webpart." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/2020/08/update-profile-picture-using-graph-api-in-sp-fx/" /><meta property="og:image" content="http://example.org/avatar.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-11T21:57:40+08:00" />
<meta property="article:modified_time" content="2020-08-11T21:57:40+08:00" /><meta property="og:site_name" content="Kunj Sangani" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://example.org/avatar.png"/>

<meta name="twitter:title" content="Update Profile Picture Using Graph API In SPFx"/>
<meta name="twitter:description" content="Using Microsoft Graph API to update profile picture for all Microsoft 365 applications via SPFx webpart."/>
<meta name="application-name" content="Kunj Sangani">
<meta name="apple-mobile-web-app-title" content="Kunj Sangani"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://example.org/2020/08/update-profile-picture-using-graph-api-in-sp-fx/" /><link rel="prev" href="http://example.org/2020/08/fetch-share-point-online-list-items-from-another-site-collection-using-pn-p-js/" /><link rel="next" href="http://example.org/2020/08/function-and-class-component-in-react-with-sp-fx/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Update Profile Picture Using Graph API In SPFx",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/example.org\/2020\/08\/update-profile-picture-using-graph-api-in-sp-fx\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "http:\/\/example.org\/images\/avatar.png",
                            "width":  960 ,
                            "height":  960 
                        }],"genre": "posts","keywords": "Teams Tab, TeamsFx, Teams Toolkit","wordcount":  956 ,
        "url": "http:\/\/example.org\/2020\/08\/update-profile-picture-using-graph-api-in-sp-fx\/","datePublished": "2020-08-11T21:57:40+08:00","dateModified": "2020-08-11T21:57:40+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "Kunj Sangani","logo": {
                    "@type": "ImageObject",
                    "url": "http:\/\/example.org\/images\/avatar.png",
                    "width":  960 ,
                    "height":  960 
                }},"author": {
                "@type": "Person",
                "name": "Kunj Sangani"
            },"description": "Using Microsoft Graph API to update profile picture for all Microsoft 365 applications via SPFx webpart."
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Kunj Sangani">Kunj Sangani</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/kunj-sangani" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Kunj Sangani">Kunj Sangani</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/kunj-sangani" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Update Profile Picture Using Graph API In SPFx</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://www.linkedin.com/in/kunj-sangani/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Kunj Sangani</a></span>&nbsp;<span class="post-category">included in <a href="/categories/spfx/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>SPFx</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2020-Aug-11">2020-Aug-11</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;956 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;5 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="introduction">Introduction</h2>
<p>Microsoft 365 has a different application in its suite. To combine all these data for developers Microsoft came up with Graph API. This has helped developers to access data across applications in Microsoft 365. One such example which we would leverage today is to save profile picture which would reflect across all the applications in Microsoft 365.</p>
<p>In this article, we will create a SPFx webpart where user can select their profile picture and on click of the save button, the profile picture will be updated for all apps in Microsoft 365.</p>
<p><strong>Step 1 - Create a SPFx Solution</strong></p>
<p>To create SPFx solution, use the below command:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">yo @microsoft/sharepoint
</span></span></code></pre></td></tr></table>
</div>
</div><p>Provide values for different questions which are asked while creating the solution as displayed in the image below:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/Update%20Profile%20Picture%20using%20Graph%20API%20SPFx.jpg"
        data-srcset="https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/Update%20Profile%20Picture%20using%20Graph%20API%20SPFx.jpg, https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/Update%20Profile%20Picture%20using%20Graph%20API%20SPFx.jpg 1.5x, https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/Update%20Profile%20Picture%20using%20Graph%20API%20SPFx.jpg 2x"
        data-sizes="auto"
        alt="https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/Update%20Profile%20Picture%20using%20Graph%20API%20SPFx.jpg"
        title="Update Profile Picture using Graph API SPFx" /></p>
<p><strong>Step 2 - Install fluent UI</strong></p>
<p>To use the icon for the file selection and deleting the file, we use the fluent UI icon. Use the below command to install it.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">npm install @fluentui/react --save
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Step 3 - Add Graph API Scopes</strong></p>
<p>Open the solution in your choice of code editor.</p>
<p>Open the file name package-solution.json which would be present inside the config folder.</p>
<p>Add the below code after the line &ldquo;isDomainIsolated&rdquo;: true:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#34;webApiPermissionRequests&#34;: [    
</span></span><span class="line"><span class="cl">   {    
</span></span><span class="line"><span class="cl">      &#34;resource&#34;: &#34;Microsoft Graph&#34;,    
</span></span><span class="line"><span class="cl">      &#34;scope&#34;: &#34;User.ReadWrite&#34;    
</span></span><span class="line"><span class="cl">   }    
</span></span><span class="line"><span class="cl">]  
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Step 4 - Add the Code for Uploading the Image as a Profile Picture</strong></p>
<p>To start updating the code, we are required to access context in our component. To do so, we need to update two files:</p>
<ol>
<li>UpdateProfilePictureWebPart.ts</li>
<li>IUpdateProfilePictureProps.ts</li>
</ol>
<p>Below is the code update that we need to do in the above-mentioned files:</p>
<p>In IUpdateProfilePictureProps.ts, replace the below code in the file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import { WebPartContext } from &#34;@microsoft/sp-webpart-base&#34;;    
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">export interface IUpdateProfilePictureProps {    
</span></span><span class="line"><span class="cl">   description: string;    
</span></span><span class="line"><span class="cl">   context:WebPartContext;    
</span></span><span class="line"><span class="cl">}   
</span></span></code></pre></td></tr></table>
</div>
</div><p>In UpdateProfilePictureWebPart.ts, update the render method pass additional parameter named context to UpdateProfilePicture component. Hence, the final render method will look as mentioned below:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">public render(): void {  
</span></span><span class="line"><span class="cl">    const element: React.ReactElement &lt; IUpdateProfilePictureProps &gt; = React.createElement(UpdateProfilePicture, {  
</span></span><span class="line"><span class="cl">        description: this.properties.description,  
</span></span><span class="line"><span class="cl">        context: this.context  
</span></span><span class="line"><span class="cl">    });  
</span></span><span class="line"><span class="cl">    ReactDom.render(element, this.domElement);  
</span></span><span class="line"><span class="cl">}   
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now let us update the component. To update the component, we need to update the file named UpdateProfilePicture.tsx.</p>
<p>Replace it with the below code. In the below code we are using:</p>
<ul>
<li>HTML file picker which is hidden but is called in click on the icon button</li>
<li>On Selection of the file, we would display a delete icon and display the selected image as with the help of URL.createObjectURL() which would help us get the blob value of the file</li>
<li>On a click of &ldquo;Save as Profile Picture,&rdquo; we are uploading the file with the help of MSGraphClient</li>
</ul>
<p>For displaying a success or error message in the dialog box:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import * as React from &#39;react&#39;;  
</span></span><span class="line"><span class="cl">import styles from &#39;./UpdateProfilePicture.module.scss&#39;;  
</span></span><span class="line"><span class="cl">import { IUpdateProfilePictureProps } from &#39;./IUpdateProfilePictureProps&#39;;  
</span></span><span class="line"><span class="cl">import { IconButton, PrimaryButton } from &#39;@fluentui/react/lib/Button&#39;;  
</span></span><span class="line"><span class="cl">import { MSGraphClient } from &#34;@microsoft/sp-http&#34;;  
</span></span><span class="line"><span class="cl">import { Dialog, DialogFooter } from &#39;office-ui-fabric-react/lib/Dialog&#39;;  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">export interface IUpdateProfilePictureState {  
</span></span><span class="line"><span class="cl">  imageFile: FileList;  
</span></span><span class="line"><span class="cl">  open: boolean;  
</span></span><span class="line"><span class="cl">  savedMessage: string;  
</span></span><span class="line"><span class="cl">  savedMessageTitle: string;  
</span></span><span class="line"><span class="cl">}  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">export default class UpdateProfilePicture extends React.Component&lt;IUpdateProfilePictureProps, IUpdateProfilePictureState&gt; {  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  constructor(props: IUpdateProfilePictureProps) {  
</span></span><span class="line"><span class="cl">    super(props);  
</span></span><span class="line"><span class="cl">    this.state = {  
</span></span><span class="line"><span class="cl">      imageFile: null,  
</span></span><span class="line"><span class="cl">      open: true,  
</span></span><span class="line"><span class="cl">      savedMessage: &#34;&#34;,  
</span></span><span class="line"><span class="cl">      savedMessageTitle: &#34;&#34;,  
</span></span><span class="line"><span class="cl">    };  
</span></span><span class="line"><span class="cl">  }  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  private saveAsProfile = () =&gt; {  
</span></span><span class="line"><span class="cl">    var reader = new FileReader();  
</span></span><span class="line"><span class="cl">    var tempfile = this.state.imageFile[0];  
</span></span><span class="line"><span class="cl">    this.props.context.msGraphClientFactory  
</span></span><span class="line"><span class="cl">      .getClient().then((client: MSGraphClient) =&gt; {  
</span></span><span class="line"><span class="cl">        client  
</span></span><span class="line"><span class="cl">          .api(&#34;me/photo/$value&#34;)  
</span></span><span class="line"><span class="cl">          .version(&#34;v1.0&#34;).header(&#34;Content-Type&#34;, tempfile.type).put(tempfile, (err, res) =&gt; {  
</span></span><span class="line"><span class="cl">            if (!err) {  
</span></span><span class="line"><span class="cl">              this.setState({  
</span></span><span class="line"><span class="cl">                open: false, savedMessage: &#34;Your profile picture is updated&#34;,  
</span></span><span class="line"><span class="cl">                savedMessageTitle: &#34;Profile Picture Saved&#34;  
</span></span><span class="line"><span class="cl">              });  
</span></span><span class="line"><span class="cl">            } else {  
</span></span><span class="line"><span class="cl">              this.setState({  
</span></span><span class="line"><span class="cl">                open: false, savedMessage: err.message,  
</span></span><span class="line"><span class="cl">                savedMessageTitle: &#34;Error while saving Profile Picture&#34;  
</span></span><span class="line"><span class="cl">              });  
</span></span><span class="line"><span class="cl">            }  
</span></span><span class="line"><span class="cl">          });  
</span></span><span class="line"><span class="cl">      });  
</span></span><span class="line"><span class="cl">  }  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  private closeDialog = () =&gt; {  
</span></span><span class="line"><span class="cl">    this.setState({ open: true });  
</span></span><span class="line"><span class="cl">  }  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  public render(): React.ReactElement&lt;IUpdateProfilePictureProps&gt; {  
</span></span><span class="line"><span class="cl">    return (  
</span></span><span class="line"><span class="cl">      &lt;div className={styles.updateProfilePicture}&gt;  
</span></span><span class="line"><span class="cl">        &lt;div className={styles.container}&gt;  
</span></span><span class="line"><span class="cl">          &lt;div className={styles.row}&gt;  
</span></span><span class="line"><span class="cl">            &lt;label&gt;Select File&lt;/label&gt;  
</span></span><span class="line"><span class="cl">            &lt;input id=&#34;fileUpload&#34; type=&#34;file&#34; accept=&#34;image/*&#34; style={{ display: &#34;none&#34; }}  
</span></span><span class="line"><span class="cl">              onChange={(ev) =&gt; {  
</span></span><span class="line"><span class="cl">                console.log(ev.target.files);  
</span></span><span class="line"><span class="cl">                if (ev.target.files.length &gt; 0) {  
</span></span><span class="line"><span class="cl">                  this.setState({ imageFile: ev.target.files });  
</span></span><span class="line"><span class="cl">                } else {  
</span></span><span class="line"><span class="cl">                  this.setState({ imageFile: null });  
</span></span><span class="line"><span class="cl">                }  
</span></span><span class="line"><span class="cl">              }}&gt;&lt;/input&gt;  
</span></span><span class="line"><span class="cl">            &lt;IconButton iconProps={{ iconName: &#39;PictureFill&#39; }} title=&#34;PictureFill&#34; ariaLabel=&#34;PictureFill&#34;  
</span></span><span class="line"><span class="cl">              style={{ display: this.state.imageFile ? &#34;none&#34; : &#34;block&#34; }}  
</span></span><span class="line"><span class="cl">              onClick={() =&gt; {  
</span></span><span class="line"><span class="cl">                document.getElementById(&#39;fileUpload&#39;).click();  
</span></span><span class="line"><span class="cl">              }} /&gt;  
</span></span><span class="line"><span class="cl">          &lt;/div&gt;  
</span></span><span class="line"><span class="cl">          {this.state.imageFile &amp;&amp; &lt;div className={styles.row}&gt;  
</span></span><span class="line"><span class="cl">            &lt;div style={{  
</span></span><span class="line"><span class="cl">              height: 250, width: 250,  
</span></span><span class="line"><span class="cl">              display: &#34;inline-block&#34;,  
</span></span><span class="line"><span class="cl">              backgroundSize: &#34;Cover&#34;, backgroundRepeat: &#34;no-repeat&#34;,  
</span></span><span class="line"><span class="cl">              backgroundPosition: &#34;center&#34;,  
</span></span><span class="line"><span class="cl">              backgroundImage: `url(&#34;${URL.createObjectURL(this.state.imageFile[0])}&#34;)`  
</span></span><span class="line"><span class="cl">            }}&gt;&lt;/div&gt;  
</span></span><span class="line"><span class="cl">            &lt;IconButton iconProps={{ iconName: &#39;Delete&#39; }} title=&#34;Delete&#34; ariaLabel=&#34;Delete&#34;  
</span></span><span class="line"><span class="cl">              onClick={() =&gt; {  
</span></span><span class="line"><span class="cl">                this.setState({ imageFile: null });  
</span></span><span class="line"><span class="cl">              }} /&gt;  
</span></span><span class="line"><span class="cl">            &lt;div className={styles.row}&gt;  
</span></span><span class="line"><span class="cl">              &lt;PrimaryButton text=&#34;Save as Profile Picture&#34; onClick={() =&gt; { this.saveAsProfile(); }} allowDisabledFocus /&gt;  
</span></span><span class="line"><span class="cl">            &lt;/div&gt;  
</span></span><span class="line"><span class="cl">          &lt;/div&gt;}  
</span></span><span class="line"><span class="cl">          &lt;Dialog  
</span></span><span class="line"><span class="cl">            hidden={this.state.open}  
</span></span><span class="line"><span class="cl">            onDismiss={this.closeDialog}  
</span></span><span class="line"><span class="cl">            dialogContentProps={{ title: this.state.savedMessageTitle, subText: this.state.savedMessage }}  
</span></span><span class="line"><span class="cl">          &gt;  
</span></span><span class="line"><span class="cl">            &lt;DialogFooter&gt;  
</span></span><span class="line"><span class="cl">              &lt;PrimaryButton onClick={this.closeDialog} text=&#34;close&#34; /&gt;  
</span></span><span class="line"><span class="cl">            &lt;/DialogFooter&gt;  
</span></span><span class="line"><span class="cl">          &lt;/Dialog&gt;  
</span></span><span class="line"><span class="cl">        &lt;/div&gt;  
</span></span><span class="line"><span class="cl">      &lt;/div&gt;  
</span></span><span class="line"><span class="cl">    );  
</span></span><span class="line"><span class="cl">  }  
</span></span><span class="line"><span class="cl">}     
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Step 5 - Approve the Graph Request in API Management</strong></p>
<p>To use Graph API, we need to approve the scope that we are using from SharePoint Admin Portal to do so.</p>
<ol>
<li>Navigate to SharePoint Online Admin Portal</li>
<li>On the left Navigation open Advance section and click on API Access.</li>
</ol>
<p>Click on Approve, as displayed in the image below:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/ApproveGraph.png"
        data-srcset="https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/ApproveGraph.png, https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/ApproveGraph.png 1.5x, https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/ApproveGraph.png 2x"
        data-sizes="auto"
        alt="https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/ApproveGraph.png"
        title="https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/ApproveGraph.png" /></p>
<p><strong>Outcome</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/2020-08-09-17-12-41-online-video.gif"
        data-srcset="https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/2020-08-09-17-12-41-online-video.gif, https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/2020-08-09-17-12-41-online-video.gif 1.5x, https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/2020-08-09-17-12-41-online-video.gif 2x"
        data-sizes="auto"
        alt="https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/2020-08-09-17-12-41-online-video.gif"
        title="https://f4n3x6c5.stackpathcdn.com/article/update-profile-picture-using-graph-api-spfx/Images/2020-08-09-17-12-41-online-video.gif" /></p>
<h2 id="conclusion">Conclusion</h2>
<p>To update images across all the applications in Microsoft 365, graph API comes to rescue and we can create an a SPFx webpart which can be accessed by all the users in the organization and update their profile picture.</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2020-Aug-11</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/2020/08/update-profile-picture-using-graph-api-in-sp-fx/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="http://example.org/2020/08/update-profile-picture-using-graph-api-in-sp-fx/" data-title="Update Profile Picture Using Graph API In SPFx" data-via="sanganikunj" data-hashtags="Teams Tab,TeamsFx,Teams Toolkit"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://example.org/2020/08/update-profile-picture-using-graph-api-in-sp-fx/" data-hashtag="Teams Tab"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="http://example.org/2020/08/update-profile-picture-using-graph-api-in-sp-fx/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on WhatsApp" data-sharer="whatsapp" data-url="http://example.org/2020/08/update-profile-picture-using-graph-api-in-sp-fx/" data-title="Update Profile Picture Using Graph API In SPFx" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/teams-tab/">Teams Tab</a>,&nbsp;<a href="/tags/teamsfx/">TeamsFx</a>,&nbsp;<a href="/tags/teams-toolkit/">Teams Toolkit</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/2020/08/fetch-share-point-online-list-items-from-another-site-collection-using-pn-p-js/" class="prev" rel="prev" title="Fetch SP list items from another site using PnP JS."><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Fetch SP list items from another site using PnP JS.</a>
            <a href="/2020/08/function-and-class-component-in-react-with-sp-fx/" class="next" rel="next" title="Function And Class Component In React With SPFx">Function And Class Component In React With SPFx<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Kunj Sangani</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/algoliasearch/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"lightgallery":true,"search":{"algoliaAppID":"1X7YJ8VWPT","algoliaIndex":"index.en","algoliaSearchKey":"00a0369aedac90b4135d976a8a7b12b8","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
