<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Custom Connector To Connect Graph API In PowerApps - Kunj Sangani</title><meta name="Description" content="Learn how to create a custom connector for Microsoft Graph API in PowerApps to access data sources across Microsoft 365 platform for app development."><meta property="og:title" content="Custom Connector To Connect Graph API In PowerApps" />
<meta property="og:description" content="Learn how to create a custom connector for Microsoft Graph API in PowerApps to access data sources across Microsoft 365 platform for app development." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/2020/06/custom-connector-to-connect-graph-api-in-power-apps/" /><meta property="og:image" content="http://example.org/avatar.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-06-23T21:57:40+08:00" />
<meta property="article:modified_time" content="2020-06-23T21:57:40+08:00" /><meta property="og:site_name" content="Kunj Sangani" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://example.org/avatar.png"/>

<meta name="twitter:title" content="Custom Connector To Connect Graph API In PowerApps"/>
<meta name="twitter:description" content="Learn how to create a custom connector for Microsoft Graph API in PowerApps to access data sources across Microsoft 365 platform for app development."/>
<meta name="application-name" content="Kunj Sangani">
<meta name="apple-mobile-web-app-title" content="Kunj Sangani"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://example.org/2020/06/custom-connector-to-connect-graph-api-in-power-apps/" /><link rel="prev" href="http://example.org/2020/06/variables-in-power-apps/" /><link rel="next" href="http://example.org/2020/06/share-point-csom-for-net-standard/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Custom Connector To Connect Graph API In PowerApps",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/example.org\/2020\/06\/custom-connector-to-connect-graph-api-in-power-apps\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "http:\/\/example.org\/images\/avatar.png",
                            "width":  960 ,
                            "height":  960 
                        }],"genre": "posts","keywords": "PowerApps, Custom Connector","wordcount":  881 ,
        "url": "http:\/\/example.org\/2020\/06\/custom-connector-to-connect-graph-api-in-power-apps\/","datePublished": "2020-06-23T21:57:40+08:00","dateModified": "2020-06-23T21:57:40+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "Kunj Sangani","logo": {
                    "@type": "ImageObject",
                    "url": "http:\/\/example.org\/images\/avatar.png",
                    "width":  960 ,
                    "height":  960 
                }},"author": {
                "@type": "Person",
                "name": "Kunj Sangani"
            },"description": "Learn how to create a custom connector for Microsoft Graph API in PowerApps to access data sources across Microsoft 365 platform for app development."
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Kunj Sangani">Kunj Sangani</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/kunj-sangani" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Kunj Sangani">Kunj Sangani</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/kunj-sangani" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Custom Connector To Connect Graph API In PowerApps</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://www.linkedin.com/in/kunj-sangani/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Kunj Sangani</a></span>&nbsp;<span class="post-category">included in <a href="/categories/powerapps/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>PowerApps</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2020-Jun-23">2020-Jun-23</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;881 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;5 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#prerequisites"><strong>Prerequisites</strong></a></li>
    <li><a href="#step-2---create-a-custom-connector-for-graph-api-in-powerapps"><strong>Step 2 - Create a Custom Connector for Graph API in PowerApps</strong></a></li>
    <li><a href="#step-3---create-powerapp-and-use-the-custom-connector"><strong>Step 3 - Create PowerApp and use the custom connector</strong></a></li>
    <li><a href="#conclusion">Conclusion </a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="introduction">Introduction</h2>
<p>PowerApps is a platform where we can build no code or less code application. This tool is available with Microsoft 365 suit and is very powerful in terms of application development with lots of functions available as per your needs.</p>
<p>But in most cases, when we create a custom application, we would like to connect to the different data sources. One of those data sources for Microsoft 365 is Graph API. This API gives us access to all the applications across the M365 platform. Therefore, to use graph API in Power Apps we need to create a custom connector. Let&rsquo;s understand how we can create a custom connector for Graph API in PowerApps</p>
<h2 id="prerequisites"><strong>Prerequisites</strong></h2>
<p>Create an Azure AD Application and provide appropriate access for Graph API. To create an Azure AD application, follow the below steps.</p>
<ul>
<li>Navigate to <a href="https://portal.azure.com/" target="_blank" rel="noopener noreffer ">here</a>.</li>
<li>Select Azure Active Directory Azure Service</li>
<li>Select the App registration option and click on the + New registration button to register a new application</li>
<li>Provide the Name of application &ldquo;PowerAppGraphAPI&rdquo; and click on Register</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AzureADApplication.png"
        data-srcset="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AzureADApplication.png, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AzureADApplication.png 1.5x, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AzureADApplication.png 2x"
        data-sizes="auto"
        alt="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AzureADApplication.png"
        title="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AzureADApplication.png" /></p>
<ul>
<li>Now let&rsquo;s create a client secret by selecting the option Certificates &amp; secrets and then selecting + New client secret. This would ask for the description and the expiry time of the secret let us provide &ldquo;secret&rdquo; in the description and select never for the expiry time duration.</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AzureADSecret.png"
        data-srcset="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AzureADSecret.png, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AzureADSecret.png 1.5x, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AzureADSecret.png 2x"
        data-sizes="auto"
        alt="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AzureADSecret.png"
        title="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AzureADSecret.png" /></p>
<ul>
<li>Copy the secret that was generated. It will add the custom connector for PowerApps</li>
<li>Now we need to provide access to Graph API to do so click on API permission and click on + Add permission from the Microsoft Graph API section under delegated permission we can select any permission as per our need and can grant admin consent</li>
<li>Copy the Azure AD Application ID which was generated and is used while registering the custom connector for Azure AD application</li>
</ul>
<h2 id="step-2---create-a-custom-connector-for-graph-api-in-powerapps"><strong>Step 2 - Create a Custom Connector for Graph API in PowerApps</strong></h2>
<p>For registering the custom navigator, follow the below steps:</p>
<ul>
<li>Navigate <a href="https://make.powerapps.com/" target="_blank" rel="noopener noreffer ">here</a>.</li>
<li>Expand the Data section and select Custom Navigator</li>
<li>Click on + New custom connector and select create from a blank</li>
<li>Provide the name of the connector as GraphAPI and click on continue</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/1_CreateNewConnector.png"
        data-srcset="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/1_CreateNewConnector.png, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/1_CreateNewConnector.png 1.5x, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/1_CreateNewConnector.png 2x"
        data-sizes="auto"
        alt="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/1_CreateNewConnector.png"
        title="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/1_CreateNewConnector.png" /></p>
<ul>
<li>
<p>We would be provided with a form for creating a custom connector with 4 different sections General, Security, Definition, Test</p>
</li>
<li>
<p>In the General, Section Update the hostname with the below value</p>
<p><em>graph.microsoft.com</em></p>
</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/2_AddHost.png"
        data-srcset="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/2_AddHost.png, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/2_AddHost.png 1.5x, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/2_AddHost.png 2x"
        data-sizes="auto"
        alt="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/2_AddHost.png"
        title="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/2_AddHost.png" /></p>
<ul>
<li>Click on the Security to move forward in the form</li>
<li>In the security, section change the authentication type from No authentication to OAuth 2.0</li>
<li>Change the identity provider to Azure Active Directory and paste the client ID and client secret which we generated from the above section while registering Azure AD application</li>
<li>In the Resource, URL section update the value as <a href="https://graph.microsoft.com" target="_blank" rel="noopener noreffer ">https://graph.microsoft.com</a></li>
<li>Now click on Definition to move forward and complete the registration</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AuthType.png"
        data-srcset="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AuthType.png, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AuthType.png 1.5x, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AuthType.png 2x"
        data-sizes="auto"
        alt="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AuthType.png"
        title="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/3_AuthType.png" /></p>
<ul>
<li>Click on Create Connector</li>
<li>Now navigate back to security and copy the redirect URL and paste In the Azure AD created in the pre-requisite section and add it by clicking on Add a Redirect URI and click on + Add platform and select web and paste the URI and click on configure</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/4_AzureADRedirectURL.png"
        data-srcset="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/4_AzureADRedirectURL.png, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/4_AzureADRedirectURL.png 1.5x, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/4_AzureADRedirectURL.png 2x"
        data-sizes="auto"
        alt="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/4_AzureADRedirectURL.png"
        title="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/4_AzureADRedirectURL.png" /></p>
<ul>
<li>Now in the definition section click on + New action to add the graph API endpoint</li>
<li>Add the values as displayed in the image below</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/5_NewAction.png"
        data-srcset="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/5_NewAction.png, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/5_NewAction.png 1.5x, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/5_NewAction.png 2x"
        data-sizes="auto"
        alt="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/5_NewAction.png"
        title="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/5_NewAction.png" /></p>
<ul>
<li>In the request part, click on Import from the sample and select Get and in the URL section add /v1.0/me/</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/6_ImportRequest.png"
        data-srcset="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/6_ImportRequest.png, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/6_ImportRequest.png 1.5x, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/6_ImportRequest.png 2x"
        data-sizes="auto"
        alt="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/6_ImportRequest.png"
        title="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/6_ImportRequest.png" /></p>
<ul>
<li>In the response part, click on add default response and past the JSON by navigating to graph explorer and getting the JSON <a href="https://developer.microsoft.com/en-us/graph/graph-explorer/preview" target="_blank" rel="noopener noreffer ">here</a>.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{  
</span></span><span class="line"><span class="cl">    &#34;@odata.context&#34;: &#34;https://graph.microsoft.com/v1.0/$metadata#users/$entity&#34;,  
</span></span><span class="line"><span class="cl">    &#34;businessPhones&#34;: [&#34;+1 412 555 0109&#34;],  
</span></span><span class="line"><span class="cl">    &#34;displayName&#34;: &#34;Megan Bowen&#34;,  
</span></span><span class="line"><span class="cl">    &#34;givenName&#34;: &#34;Megan&#34;,  
</span></span><span class="line"><span class="cl">    &#34;jobTitle&#34;: &#34;Auditor&#34;,  
</span></span><span class="line"><span class="cl">    &#34;mail&#34;: &#34;MeganB@M365x214355.onmicrosoft.com&#34;,  
</span></span><span class="line"><span class="cl">    &#34;mobilePhone&#34;: null,  
</span></span><span class="line"><span class="cl">    &#34;officeLocation&#34;: &#34;12/1110&#34;,  
</span></span><span class="line"><span class="cl">    &#34;preferredLanguage&#34;: &#34;en-US&#34;,  
</span></span><span class="line"><span class="cl">    &#34;surname&#34;: &#34;Bowen&#34;,  
</span></span><span class="line"><span class="cl">    &#34;userPrincipalName&#34;: &#34;MeganB@M365x214355.onmicrosoft.com&#34;,  
</span></span><span class="line"><span class="cl">    &#34;id&#34;: &#34;48d31887-5fad-4d73-a9f5-3c356e68a038&#34;  
</span></span><span class="line"><span class="cl">} 
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/7_ImportResponse.png"
        data-srcset="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/7_ImportResponse.png, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/7_ImportResponse.png 1.5x, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/7_ImportResponse.png 2x"
        data-sizes="auto"
        alt="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/7_ImportResponse.png"
        title="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/7_ImportResponse.png" /></p>
<ul>
<li>Click on Test and click on Update Connector. Now let&rsquo;s use this connector in our Power App</li>
</ul>
<h2 id="step-3---create-powerapp-and-use-the-custom-connector"><strong>Step 3 - Create PowerApp and use the custom connector</strong></h2>
<p>To use the custom connector we created, we create a blank canvas application and add the connection to the graph connector that we created</p>
<p>Follow the below steps to create PowerApp and add a reference to the custom connector:</p>
<ul>
<li>Navigate to <a href="https://make.powerapps.com" target="_blank" rel="noopener noreffer ">https://make.powerapps.com</a></li>
<li>Click on create</li>
<li>Select Canvas app from blank as a type of PowerApps</li>
<li>Provide the name of the app as GraphAPIUser and select the format as Tablet</li>
<li>Add a four text input, four labels, and button</li>
<li>Change the label text as &ldquo;First Name&rdquo;, &ldquo;Last Name&rdquo;, &ldquo;Email Address&rdquo;, &ldquo;User ID&rdquo;</li>
<li>Change the text of the button as &ldquo;Fetch User Data&rdquo;</li>
<li>Now add a connection to the GraphAPI connector that we created by selecting data source and expanding connectors section and selecting the connector that we created.</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/8_AddConnection.png"
        data-srcset="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/8_AddConnection.png, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/8_AddConnection.png 1.5x, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/8_AddConnection.png 2x"
        data-sizes="auto"
        alt="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/8_AddConnection.png"
        title="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/8_AddConnection.png" /></p>
<ul>
<li>Select the button and update the formula to fetch the user data by adding the below formula in OnSelect field</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">UpdateContext({MyProfile:GraphAPI.getmyuserprofile()})  
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Update the default property of all the four text field with the below values:</li>
</ul>
<ol>
<li>MyProfile.givenName</li>
<li>MyProfile.surname</li>
<li>MyProfile.mail</li>
<li>MyProfile.id</li>
</ol>
<ul>
<li>Finally, the application is ready. Now, when we click on the Fetch user Data button, we will get current users details from Graph API.</li>
</ul>
<p><strong>Outcome</strong></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/outcome.gif"
        data-srcset="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/outcome.gif, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/outcome.gif 1.5x, https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/outcome.gif 2x"
        data-sizes="auto"
        alt="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/outcome.gif"
        title="https://f4n3x6c5.stackpathcdn.com/article/custom-connector-to-connect-graph-api-in-powerapps/Images/outcome.gif" /></p>
<h2 id="conclusion">Conclusion </h2>
<p>With the help of a custom connector, we can leverage graph API in PowerApps. Even custom connector becomes very handy if we want to connect to any third party application whose connector is not available</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2020-Jun-23</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/2020/06/custom-connector-to-connect-graph-api-in-power-apps/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="http://example.org/2020/06/custom-connector-to-connect-graph-api-in-power-apps/" data-title="Custom Connector To Connect Graph API In PowerApps" data-via="sanganikunj" data-hashtags="PowerApps,Custom Connector"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://example.org/2020/06/custom-connector-to-connect-graph-api-in-power-apps/" data-hashtag="PowerApps"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="http://example.org/2020/06/custom-connector-to-connect-graph-api-in-power-apps/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on WhatsApp" data-sharer="whatsapp" data-url="http://example.org/2020/06/custom-connector-to-connect-graph-api-in-power-apps/" data-title="Custom Connector To Connect Graph API In PowerApps" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/powerapps/">PowerApps</a>,&nbsp;<a href="/tags/custom-connector/">Custom Connector</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/2020/06/variables-in-power-apps/" class="prev" rel="prev" title="Variables In PowerApps"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Variables In PowerApps</a>
            <a href="/2020/06/share-point-csom-for-net-standard/" class="next" rel="next" title="SharePoint CSOM For .NET Standard">SharePoint CSOM For .NET Standard<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Kunj Sangani</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/algoliasearch/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"lightgallery":true,"search":{"algoliaAppID":"1X7YJ8VWPT","algoliaIndex":"index.en","algoliaSearchKey":"00a0369aedac90b4135d976a8a7b12b8","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
